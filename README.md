# [Backstage](https://backstage.io) with [3 Musketeers](https://3musketeers.io)

Spotify Backstage accelerator to generate a 3 Musketeers friendly Backstage application.

Note: If you're using an older version of compose you may need to replace `docker compose` with docker-compose` in the Makefile.

## Step 1. Bootstrapping your own Backstage App

To generate your own Backstage application, fork this repo and run:

```sh
mkdir -p /tmp/backstage/data
ENVFILE=env.example make envfile
make bootstrap
```
## Step 2. Running your Backstage App locally

Once you've bootstrapped your app, you can run it locally by executing the following:

```sh
ENVFILE=env.example make envfile
make deps
make dev
```

You should be able to access the page via: <http://localhost:3000>.

---

## More Info: Variables and Env Setup

Running `ENVFILE=env.example make envfile` will create a `.env` file that should look something like this:

```
% cat .env
POSTGRES_USER=backstage
POSTGRES_PASSWORD=backstage
POSTGRES_HOST=backstagedb
POSTGRES_PORT=5432
DB_LOCAL_PATH=/tmp/backstage/data
AWS_PROFILE=tech-mod
AWS_REGION=us-west-2
TF_VAR_image_tag=0.10.0
GITHUB_CLIENT_ID=<from Backstage Github app generated by backstage-cli get from teammate>
GITHUB_CLIENT_SECRET=<from Backstage Github app generated by backstage-cli get from teammate>
GITHUB_WEBHOOK_SECRET=<from Backstage Github app generated by backstage-cli get from teammate>
GITHUB_PRIVATE_KEY=<from Backstage Github app generated by backstage-cli get from teammate>
```

At the very least, you'll need to have a valid folder path for `DB_LOCAL_PATH`:
- In our example we ran `mkdir -p /tmp/backstage/data` before spinning up backstage
 
For full functionality you'll need valid AWS and GitHub credentials too.
